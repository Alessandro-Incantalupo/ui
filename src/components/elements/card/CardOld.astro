---
import type { Props as HeadingProps } from '../Heading.astro'
import Heading from '../Heading.astro'
import Icon from '../Icon.astro'
import type { Props as PriceProps } from '../Price.astro'
import Price from '../Price.astro'
import type { Props as RatingProps } from '../Rating.astro'
import Rating from '../Rating.astro'
import type { Props as TaglineProps } from '../Tagline.astro'
import Tagline from '../Tagline.astro'
import type { Props as TextProps } from '../Text.astro'
import Text from '../Text.astro'
import type { Props as ButtonGroupProps } from '../button/ButtonGroup.astro'
import ButtonGroup from '../button/ButtonGroup.astro'
import type { Props as ImageProps } from '../image/Image.astro'
import Image from '../image/Image.astro'
import type { Props as SpecsProps } from '../spec/Specs.astro'
import Specs from '../spec/Specs.astro'
import type { Props as CardRootProps } from './CardRoot.astro'
import CardRoot from './CardRoot.astro'
import type { Props as CardSegmentProps } from './CardSegment.astro'
import CardSegment from './CardSegment.astro'
import type { Props as CardWriteupProps } from './CardWriteup.astro'
import CardWriteup from './CardWriteup.astro'

// TODO: add entry prop
// add reference prop
// collection + slug (= query?) {collection: "products", slug: "slug"} or ["products", "slug"]
export interface Props
  extends CardRootProps,
    CardSegmentProps,
    RatingProps,
    CardWriteupProps,
    TaglineProps,
    HeadingProps,
    TextProps,
    PriceProps,
    SpecsProps,
    ButtonGroupProps {
  image?: ImageProps | null
  query?: {
    collection: string
    slug: string
  }
  reference?: any
}

const { props } = Astro
---

<CardRoot {...props}>
  <Image
    {...props.images?.[0]}
    {...props.image}
  />
  <slot />
  <CardSegment {...props}>
    <Icon
      large
      {...props}
    />
    <Rating {...props} />
    <CardWriteup {...props}>
      <Tagline {...props} />
      <Heading {...props} />
      <Text {...props} />
      <Price {...props} />
      <slot name="writeup" />
    </CardWriteup>
    <Specs {...props} />
    <ButtonGroup {...props} />
    <slot name="segment" />
  </CardSegment>
</CardRoot>
