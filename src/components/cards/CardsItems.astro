---
import type { ComponentProps } from 'astro/types'
import { getCollection } from 'astro:content'
import { Card } from '../card'

interface Props extends ComponentProps<typeof Card> {
  cards?: (
    | ComponentProps<typeof Card>
    | ComponentProps<typeof Card>['slug']
    | null
  )[]
}

let { cards, collection, ..._card } = Astro.props

if ((!cards || cards.length === 0) && collection) {
  const items = await getCollection(collection)
  const slugs = items.map(({ slug }) => slug)
  cards = slugs
}
---

{
  cards?.map((card) => {
    if (!card) return null
    if (typeof card === 'string') card = { slug: card }
    return (
      <Card
        {collection}
        {..._card}
        {...card}
      />
    )
  })
}
