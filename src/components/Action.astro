---
import type { ComponentProps } from 'astro/types'
import { buildProps, type BuildProps } from '../utils'
import Buttons from './Buttons.astro'
import Form from './Form.astro'
import Price from './Price.astro'
import Product from './Product.astro'
import Tag from './Tag.astro'

interface Base
  extends Pick<ComponentProps<typeof Form>, 'form' | '_form'>,
    ComponentProps<typeof Product>,
    Pick<ComponentProps<typeof Buttons>, 'buttons' | '_buttons'> {
  align?: 'start' | 'center' | 'stretch' | null
}

type Props = BuildProps<Base, 'action'>
const props = buildProps(Astro, 'action')

const {
  form,
  _form,
  price,
  _price,
  fields,
  _fields,
  button,
  _button,
  buttons,
  _buttons,
  title,
  _title,
  description,
  _description,
  image,
  _image,
  ...rest
} = props
---

<Tag {...rest}>
  <Form
    {form}
    {_form}
  />
  <!-- <FullcartAdd
    {price}
    {variants}
    id="my-cool-product"
  /> -->
  <!-- <Price
    {price}
    {_price}
  /> -->
  <Buttons
    {buttons}
    {_buttons}
  />
  <Product
    {price}
    {_price}
    {fields}
    {_fields}
    {button}
    {_button}
    {title}
    {_title}
    {description}
    {_description}
    {image}
    {_image}
  />
  <slot />
</Tag>

<style is:global>
  .action {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
  }
</style>
