---
import type { ComponentProps } from 'astro/types'
import { getCollection } from 'astro:content'
import type { CategoriesDeck } from '.'
import Section from '../../elements/section/Section.astro'

export interface Props
  extends ComponentProps<typeof CategoriesDeck>,
    Pick<
      ComponentProps<typeof Section>,
      'tagline' | 'heading' | 'text' | 'buttons'
    > {}

const { props } = Astro

const allEntries = await getCollection('categories')

const mappedCategories = props.categories?.map((category) => {
  // @ts-ignore
  const found = allEntries.find((entry) => category.includes(entry.slug))
  return found?.data
})
---

<Section
  class="categories-section"
  cards={mappedCategories}
  {...props}
/>
