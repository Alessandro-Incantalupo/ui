---
import type { ComponentProps, HTMLTag } from 'astro/types'
import Button from './Button.astro'
import MasterCard from './MasterCard.astro'

type Props<As extends HTMLTag = 'a'> = ComponentProps<typeof MasterCard<As>> & {
  label?: string
  icon?: string
}

const { label, icon, variant, id = 'dialog', ...rest } = Astro.props
---

<Button
  as="button"
  type="button"
  id={`${id}-button`}
  text={label}
  icon={icon}
  {variant}
  onclick={`document.getElementById('${id}').showModal()`}
/>

<dialog
  class="dialog"
  {id}
  onclick={`event.target === this && this.close()`}
>
  <MasterCard {...rest}>
    <slot />
  </MasterCard>
</dialog>

<style lang="scss" is:global>
  .dialog {
    margin: auto !important;
    outline: 0;
    border: 0;
    background: none;
    padding: 0;
    max-width: 768px;
    max-height: 80vh;
    overflow: hidden;

    &::backdrop {
      background: rgba(0, 0, 0, 0.5);
    }

    .card {
      width: 100%;
      height: 100%;
      max-height: 80vh !important;
      overflow: auto !important;
    }
  }
</style>
