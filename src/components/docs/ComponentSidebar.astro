---
import Search from 'astro-pagefind/components/Search'
import { getCollection } from 'astro:content'
import Link from 'fulldev-ui/components/Link.astro'
import Column from 'fulldev-ui/components/structures/Column.astro'

const componentPages = await getCollection('pages', (entry: any) =>
  entry.slug.startsWith('components/')
)
---

<Column
  as="aside"
  class="sidebar"
>
  <Search
    id="search"
    className="pagefind-ui"
    uiOptions={{ showImages: false }}
  />
  {
    componentPages.map((page: any) => (
      <Link
        class="sidebar-link"
        href={`/${page.slug}`}
      >
        {page.data.title}
      </Link>
    ))
  }
</Column>

<style lang="scss">
  .sidebar {
    display: none;
    position: sticky;
    top: 0;
    box-sizing: border-box;
    border-right: 1px solid var(--border);
    padding: var(--space-5) var(--space-7) var(--space-5) var(--gutter);
    max-height: 100vh;
    overflow-y: auto;

    .sidebar-link {
      font-size: var(--text-1);
    }

    @media (min-width: 768px) {
      display: flex;
    }
  }
</style>
