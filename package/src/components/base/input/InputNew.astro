---
import type { ComponentProps, Polymorphic } from 'astro/types'
import Component from '../../_Component.astro'
import Group from '../../segment/Group.astro'
import Label from '../../typography/Label.astro'
import Icon from '../Icon.astro'
import InputField from './InputField.astro'

type Props<As extends 'div'> = Polymorphic<{ as: As }> &
  Pick<
    ComponentProps<typeof InputField>,
    | 'placeholder'
    | 'type'
    | 'name'
    | 'variant'
    | 'value'
    | 'disabled'
    | 'required'
    | 'control'
    | 'icon'
  > & {
    label?: ComponentProps<typeof Label> | ComponentProps<typeof Label>['html']
    field?: ComponentProps<typeof InputField>
  }

const {
  as = 'div',
  field,
  control,
  label,
  icon,
  name,
  variant,
  placeholder,
  type,
  value,
  disabled,
  required,
  ...rest
} = Astro.props
---

<Group>
  <Label
    for={name}
    html={label}
  />
  <Box>
    <Component
      as="input"
      type={'text'}
      class="input-control"
      if={true}
      {variant}
      {...rest}
    />
    <Icon />
  </Box>
</Group>

<style is:global lang="scss">
  @import '../../../css/utils.scss';

  @include component('input') {
    display: flex;
    position: relative;
    flex-direction: column;
    gap: var(--space-1);
    width: 100%;
  }
</style>
