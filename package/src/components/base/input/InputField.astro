---
import type { ComponentProps, Polymorphic } from 'astro/types'
import Component from '../../_Component.astro'
import Icon from '../Icon.astro'
import InputControl from './InputControl.astro'

type Props<As extends 'div'> = Polymorphic<{ as: As }> &
  Pick<
    ComponentProps<typeof InputControl>,
    | 'placeholder'
    | 'type'
    | 'name'
    | 'variant'
    | 'value'
    | 'disabled'
    | 'required'
  > & {
    control?: ComponentProps<typeof InputControl>
    icon?: ComponentProps<typeof Icon> | ComponentProps<typeof Icon>['name']
  }

const {
  as = 'div',
  icon,
  control,
  placeholder,
  type,
  name,
  variant,
  value,
  disabled,
  required,
  ...rest
} = Astro.props
---

<Component
  class:list={['input-field']}
  {as}
  {...rest}
>
  <!-- <Icon
    class:list={['input-icon']}
    {...typeof icon === 'string' ? { name: icon } : icon}
  /> -->
  <InputControl
    id={name}
    {placeholder}
    {type}
    {name}
    {variant}
    {value}
    {disabled}
    {required}
    {...control}
  />
</Component>

<style is:global lang="scss">
  @import '../../../css/utils.scss';

  @include component('input-field') {
    position: relative;
  }

  @include component('input-icon') {
    position: absolute;
    top: 50%;
    left: var(--space-2);
    transform: translateY(-50%);
    z-index: 2;
    pointer-events: none;
  }
</style>
