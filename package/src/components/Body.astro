---
import { z } from 'astro:content'
import { morph } from '../utils'
import Section, { macro as section } from './Section.astro'
import Sections, { macro as sections } from './Sections.astro'
import Tag from './Tag.astro'

type Props = z.infer<typeof macro>

export const { macro, meso, micro } = morph('body', {
  ...section.shape,
  ...sections.shape,
  body: z.undefined(),
  hero: section.shape.section,
  _hero: section.shape._section,
  cta: section.shape.section,
  _cta: section.shape._section,
})

const { as = 'body', hero, _hero, cta, _cta, ...rest } = meso(Astro.props)
---

<Tag
  class="body hue-base hue-accent"
  {as}
  {...rest}
>
  <!-- <Banner></Banner> -->
  <!-- <Header {...rest} /> -->
  <Sections {...rest}>
    <Section
      class="hero"
      _section={_hero}
      section={hero}
      {...micro(rest)}
      slot="before"
    />
    <Section
      class="cta"
      _section={_cta}
      section={cta}
      slot="after"
    />
  </Sections>
  <slot />
  <!-- <Footer {...rest} /> -->
  <!-- <Legal {...rest} /> -->

  <style is:global>
    .body {
      transition: var(--transition);
      background: var(--hue1);
      height: 100%;
      min-height: 100vh;
      color: var(----hue11);
      font: var(--font);

      &.dark {
        color-scheme: dark;
      }
      &.light {
        color-scheme: light;
      }
    }
  </style>
</Tag>
