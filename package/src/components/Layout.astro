---
import { z } from 'zod'
import Tag from '../components/Tag.astro'
import { buildProps, parseProps } from '../utils/props'
import Body, { bodySchema } from './Body.astro'
import Head, { headSchema } from './Head.astro'

type Props = z.infer<typeof layoutSchema>

export const layoutSchema = buildProps({
  body: bodySchema,
  head: headSchema,
  lang: z.string().nullish(),
  render: z.any().nullish(),
  hasProse: z.boolean().nullish(),
})

const {
  as = 'html',
  lang = 'en',
  render,
  hasProse,
  ...rest
} = parseProps(layoutSchema, Astro.props)
---

<!doctype html>
<Tag
  class:list={['layout']}
  lang={lang}
  as="html"
  {...rest}
>
  <Head {...rest.head}>
    <slot name="head" />
  </Head>
  <Body
    {...rest.body}
    render={hasProse ? render : undefined}
  >
    <slot name="body" />
    <slot />
  </Body>
</Tag>
