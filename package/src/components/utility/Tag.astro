---
import type { HTMLTag, Polymorphic } from 'astro/types'
import { attributesSchema } from '../../schemas/attributesSchema'

type Props<As extends HTMLTag = 'div'> = Omit<
  Polymorphic<{ as: As }>,
  'slot'
> & {
  if?: any
  color?: string
  scheme?: 'light' | 'dark'
  compact?: boolean
  density?: 'base' | 'compact'
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl'
}

const {
  as: As = 'div',
  if: ifProp,
  color,
  scheme,
  compact,
  density,
  size,
  ...rest
} = Astro.props

const slot = await Astro.slots.render('default')
const hasSlot = slot?.trim().length > 0
---

{
  (hasSlot || ifProp) && (
    <As
      class:list={[
        'full-tag',
        {
          [`full-scheme-${scheme}`]: scheme,
          [`full-color-${color}`]: color,
          [`full-size-${size}`]: size,
          [`full-density-${density}`]: density,
          [`full-compact`]: compact,
        },
      ]}
      {...attributesSchema.parse(rest)}
    >
      <Fragment set:html={slot} />
    </As>
  )
}
