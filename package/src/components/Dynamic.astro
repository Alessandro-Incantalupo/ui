---
import { z } from 'zod'
import Description from './Description.astro'
import Tagline from './Tagline.astro'
import Title from './Title.astro'

const allowedComponents: any = {
  Title,
  Description,
  Tagline,
} as const

const dynamicSchema = z
  .object({
    component: z.string().optional(),
  })
  .catchall(z.any())

const rest = dynamicSchema.parse(Astro.props)
console.log({
  props: Astro.props,
  rest,
})
---

{
  Object.entries(rest).map(([key, value]) => {
    let Component =
      allowedComponents[key.charAt(0).toUpperCase() + key.slice(1)]

    if (value?.component) Component = allowedComponents[value.component]
    if (!Component) return null

    return <Component {...value} />
  })
}
